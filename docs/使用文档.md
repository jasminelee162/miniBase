# miniBase 使用文档


## 支持的语句类别
当前编译器可以识别并处理以下 SQL 子集：

- CREATE TABLE
- INSERT INTO ... VALUES
- SELECT ... FROM ... WHERE ...
- DELETE FROM ... WHERE ...

说明：类型支持 `INT` 和 `VARCHAR`，表达式支持简单的二元比较（=, <, >, <=, >=, !=）和算术运算符 (+ - * /)。

## 语法示例与说明

- CREATE TABLE

	示例：

	CREATE TABLE users(id INT, name VARCHAR, age INT);

	说明：定义表名和列名+类型。

- INSERT

	示例：

	INSERT INTO users(id,name,age) VALUES (1,'Alice',20);

	说明：支持多列值的插入；当前实现会把值序列化为字符串类型（JSON 输出中为字符串）。

- SELECT

	示例：

	SELECT id,name FROM users WHERE age > 18;

	说明：支持简单的 WHERE 表达式，返回由 `parser`/`semantic` 认可的投影列与谓词字符串（JSON 中体现为 `columns` 和 `predicate`）。

- DELETE

	示例：

	DELETE FROM users WHERE id = 1;

	说明：支持 WHERE 子句，以便按条件删除。

## JSON 输出格式（AST -> DB-facing JSON）
编译器提供将 AST 序列化为 JSON 的功能（位于 `src/sql_compiler/parser/ast_json_serializer.cpp`），当前输出遵循下列模式：

- CreateTable

	{
		"type": "CreateTable",
		"table": "users",
		"schema": [ {"name":"id","type":"int"}, {"name":"name","type":"varchar"}, ... ]
	}

- Insert

	{
		"type": "Insert",
		"table": "users",
		"values": ["1","Alice","20"]
	}

- Select

	{
		"type": "Select",
		"table": "users",
		"columns": ["id","name"],
		"predicate": "age > 18"
	}

- Delete

	{
		"type": "Delete",
		"table": "users",
		"predicate": "id = 1"
	}

注：JSON 中的 `predicate` 是一个字符串表达式（简单文本），`columns` 为列名字符串数组。Translator（frontend/translator/json_to_plan.cpp）能消费该 JSON 并生成 PlanNode。

## 如何运行（本地）

1. 使用 CMake 配置并生成 Visual Studio/MSBuild 工程（Windows）：

```powershell
cmake -S . -B build
cmake --build build --config Debug --target e2e_flow
```

2. 运行 e2e 测试：

```powershell
.\build\tests\Debug\e2e_flow.exe
```

该测试会依次运行 Lexer → Parser → Semantic → JSON，并在控制台打印阶段标记、tokens、简化 AST 与最终 JSON（示例输出会显示在控制台）。

